{
  "tor_analysis": {
    "processes": [
      {
        "pid": 589,
        "name": "contextstored",
        "cmdline": [
          "/System/Library/PrivateFrameworks/CoreDuetContext.framework/Resources/contextstored"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 918,
        "name": "applekeystored",
        "cmdline": [
          "/usr/libexec/applekeystored"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 951,
        "name": "ContextStoreAgent",
        "cmdline": [
          "/System/Library/PrivateFrameworks/CoreDuetContext.framework/Resources/ContextStoreAgent"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1044,
        "name": "NFStorageServer",
        "cmdline": [
          "/System/Library/PrivateFrameworks/NearFieldPrivateServices.framework/Versions/A/XPCServices/NFStorageServer.xpc/Contents/MacOS/NFStorageServer"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1048,
        "name": "SetStoreUpdateService",
        "cmdline": [
          "/System/Library/PrivateFrameworks/CascadeSets.framework/Versions/A/XPCServices/SetStoreUpdateService.xpc/Contents/MacOS/SetStoreUpdateService"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1119,
        "name": "AssetCacheLocatorService",
        "cmdline": [
          "/System/Library/PrivateFrameworks/AssetCacheServices.framework/Versions/A/XPCServices/AssetCacheLocatorService.xpc/Contents/MacOS/AssetCacheLocatorService",
          "-a"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1165,
        "name": "AssetCacheTetheratorService",
        "cmdline": [
          "/System/Library/PrivateFrameworks/AssetCacheServicesExtensions.framework/XPCServices/AssetCacheTetheratorService.xpc/Contents/MacOS/AssetCacheTetheratorService"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1347,
        "name": "CallHistoryPluginHelper",
        "cmdline": [
          "/System/Library/PrivateFrameworks/CallHistory.framework/Support/CallHistoryPluginHelper"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1361,
        "name": "storekitagent",
        "cmdline": [
          "/System/Library/Frameworks/StoreKit.framework/Support/storekitagent"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1439,
        "name": "ANEStorageMaintainer",
        "cmdline": [
          "/System/Library/PrivateFrameworks/AppleNeuralEngine.framework/XPCServices/ANEStorageMaintainer.xpc/Contents/MacOS/ANEStorageMaintainer"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 1440,
        "name": "ANEStorageMaintainer",
        "cmdline": [
          "/System/Library/PrivateFrameworks/AppleNeuralEngine.framework/XPCServices/ANEStorageMaintainer.xpc/Contents/MacOS/ANEStorageMaintainer"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 4757,
        "name": "AssetCacheLocatorService",
        "cmdline": [
          "/System/Library/PrivateFrameworks/AssetCacheServices.framework/Versions/A/XPCServices/AssetCacheLocatorService.xpc/Contents/MacOS/AssetCacheLocatorService",
          "-d"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 4822,
        "name": "ManifestStorageService",
        "cmdline": [
          "/System/Library/PrivateFrameworks/MobileAsset.framework/Versions/A/XPCServices/ManifestStorageService.xpc/Contents/MacOS/ManifestStorageService"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 25144,
        "name": "SAExtensionOrchestrator",
        "cmdline": [
          "/System/Library/PrivateFrameworks/SiriAnalytics.framework/Versions/A/XPCServices/SAExtensionOrchestrator.xpc/Contents/MacOS/SAExtensionOrchestrator"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 32285,
        "name": "thermalmonitord",
        "cmdline": [
          "/usr/libexec/thermalmonitord"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 32292,
        "name": "opendirectoryd",
        "cmdline": [
          "/usr/libexec/opendirectoryd"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 32301,
        "name": "mds_stores",
        "cmdline": [
          "/System/Library/Frameworks/CoreServices.framework/Frameworks/Metadata.framework/Versions/A/Support/mds_stores"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 33242,
        "name": "amsondevicestoraged",
        "cmdline": [
          "/System/Library/PrivateFrameworks/OnDeviceStorage.framework/Support/amsondevicestoraged"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 33441,
        "name": "webinspectord",
        "cmdline": [
          "/System/Cryptexes/App/usr/libexec/webinspectord"
        ],
        "connections": 0,
        "listening_ports": []
      },
      {
        "pid": 35882,
        "name": "tor",
        "cmdline": [
          "tor",
          "-f",
          "-",
          "__OwningControllerProcess",
          "35880"
        ],
        "connections": 10,
        "listening_ports": [
          9050,
          9051
        ]
      }
    ],
    "configuration": {
      "tor_running": true,
      "multiple_instances": true,
      "listening_ports": [
        9050,
        9051
      ],
      "security_assessment": [
        "SOCKS proxy detected on standard port",
        "Control port detected - potential security risk"
      ]
    },
    "connectivity": {
      "socks_proxy_working": true,
      "ip_leak_test": "No direct IP exposure detected in local traffic",
      "dns_leak_test": null,
      "circuit_info": null
    }
  },
  "traffic_analysis": {
    "total_packets": 3734,
    "tor_packets": 54,
    "unique_connections": 16,
    "avg_packet_size": 137.10096411355116,
    "size_variance": 91530.48940169546,
    "timing_patterns": {
      "avg_interval": 0.01551278790196141,
      "interval_variance": 0.027649982244793318,
      "min_interval": 5.316734313964844e-05,
      "max_interval": 2.0725810527801514,
      "regular_pattern_detected": false
    },
    "size_patterns": {
      "unique_sizes": 40,
      "most_common_sizes": [
        [
          56,
          500
        ],
        [
          69,
          76
        ],
        [
          60,
          51
        ],
        [
          70,
          41
        ],
        [
          84,
          32
        ]
      ],
      "size_distribution": {
        "416": 8,
        "56": 500,
        "82": 25,
        "108": 8,
        "486": 8,
        "88": 16,
        "69": 76,
        "61": 26,
        "60": 51,
        "214": 9,
        "70": 41,
        "72": 28,
        "894": 8,
        "164": 8,
        "1010": 8,
        "984": 8,
        "86": 16,
        "100": 16,
        "248": 16,
        "84": 32,
        "110": 16,
        "230": 16,
        "760": 8,
        "150": 8,
        "638": 8,
        "1062": 8,
        "104": 7,
        "96": 3,
        "66": 3,
        "384": 2,
        "585": 2,
        "304": 2,
        "5498": 2,
        "112": 1,
        "208": 1,
        "106": 1,
        "142": 1,
        "2390": 1,
        "78": 1,
        "2867": 1
      },
      "padding_detected": false
    },
    "connection_patterns": {
      "127.0.0.1:49719->127.0.0.1:9092": {
        "packet_count": 1202,
        "duration": 57.87122869491577,
        "total_bytes": 182948,
        "avg_packet_size": 152.20299500831948,
        "is_tor_connection": false
      },
      "127.0.0.1:9092->127.0.0.1:49719": {
        "packet_count": 1202,
        "duration": 57.870620250701904,
        "total_bytes": 127772,
        "avg_packet_size": 106.29950083194676,
        "is_tor_connection": false
      },
      "127.0.0.1:49722->127.0.0.1:9092": {
        "packet_count": 526,
        "duration": 57.8554630279541,
        "total_bytes": 61230,
        "avg_packet_size": 116.40684410646388,
        "is_tor_connection": false
      },
      "127.0.0.1:9092->127.0.0.1:49722": {
        "packet_count": 526,
        "duration": 57.85523200035095,
        "total_bytes": 50472,
        "avg_packet_size": 95.95437262357414,
        "is_tor_connection": false
      },
      "127.0.0.1:49868->127.0.0.1:9050": {
        "packet_count": 9,
        "duration": 34.44234323501587,
        "total_bytes": 4404,
        "avg_packet_size": 489.3333333333333,
        "is_tor_connection": true
      },
      "127.0.0.1:9050->127.0.0.1:49868": {
        "packet_count": 9,
        "duration": 34.44201898574829,
        "total_bytes": 3624,
        "avg_packet_size": 402.6666666666667,
        "is_tor_connection": true
      },
      "127.0.0.1:49870->127.0.0.1:8080": {
        "packet_count": 9,
        "duration": 34.520374059677124,
        "total_bytes": 4404,
        "avg_packet_size": 489.3333333333333,
        "is_tor_connection": true
      },
      "127.0.0.1:8080->127.0.0.1:49870": {
        "packet_count": 9,
        "duration": 34.52095913887024,
        "total_bytes": 3624,
        "avg_packet_size": 402.6666666666667,
        "is_tor_connection": true
      },
      "127.0.0.1:8080->127.0.0.1:49860": {
        "packet_count": 9,
        "duration": 34.521350145339966,
        "total_bytes": 5184,
        "avg_packet_size": 576,
        "is_tor_connection": true
      },
      "127.0.0.1:49860->127.0.0.1:8080": {
        "packet_count": 9,
        "duration": 34.521549224853516,
        "total_bytes": 2844,
        "avg_packet_size": 316,
        "is_tor_connection": true
      },
      "127.0.0.1:49712->127.0.0.1:9001": {
        "packet_count": 24,
        "duration": 50.27625608444214,
        "total_bytes": 4800,
        "avg_packet_size": 200,
        "is_tor_connection": false
      },
      "127.0.0.1:9001->127.0.0.1:49712": {
        "packet_count": 24,
        "duration": 50.27593421936035,
        "total_bytes": 37170,
        "avg_packet_size": 1548.75,
        "is_tor_connection": false
      },
      "127.0.0.1:49787->127.0.0.1:7265": {
        "packet_count": 4,
        "duration": 24.002028703689575,
        "total_bytes": 320,
        "avg_packet_size": 80,
        "is_tor_connection": false
      },
      "127.0.0.1:7265->127.0.0.1:49787": {
        "packet_count": 4,
        "duration": 24.00178813934326,
        "total_bytes": 332,
        "avg_packet_size": 83,
        "is_tor_connection": false
      },
      "127.0.0.1:49691->127.0.0.1:9092": {
        "packet_count": 84,
        "duration": 40.39271283149719,
        "total_bytes": 11448,
        "avg_packet_size": 136.28571428571428,
        "is_tor_connection": false
      },
      "127.0.0.1:9092->127.0.0.1:49691": {
        "packet_count": 84,
        "duration": 40.39213180541992,
        "total_bytes": 11359,
        "avg_packet_size": 135.22619047619048,
        "is_tor_connection": false
      }
    }
  },
  "correlation_analysis": {
    "time_windows_analyzed": 13,
    "correlation_risk": "HIGH",
    "patterns_detected": [
      "Traffic burst detected in window 349672885 (242 packets)",
      "Regular timing pattern in window 349672885",
      "Traffic burst detected in window 349672886 (362 packets)",
      "Regular timing pattern in window 349672886",
      "Traffic burst detected in window 349672887 (252 packets)",
      "Regular timing pattern in window 349672887",
      "Traffic burst detected in window 349672888 (458 packets)",
      "Regular timing pattern in window 349672888",
      "Traffic burst detected in window 349672889 (246 packets)",
      "Regular timing pattern in window 349672889",
      "Traffic burst detected in window 349672890 (314 packets)",
      "Regular timing pattern in window 349672890",
      "Traffic burst detected in window 349672891 (358 packets)",
      "Regular timing pattern in window 349672891",
      "Traffic burst detected in window 349672892 (250 packets)",
      "Regular timing pattern in window 349672892",
      "Traffic burst detected in window 349672893 (348 packets)",
      "Regular timing pattern in window 349672893",
      "Traffic burst detected in window 349672894 (236 packets)",
      "Regular timing pattern in window 349672894",
      "Traffic burst detected in window 349672895 (360 packets)",
      "Regular timing pattern in window 349672895",
      "Traffic burst detected in window 349672896 (300 packets)",
      "Regular timing pattern in window 349672896",
      "Regular timing pattern in window 349672897"
    ],
    "recommendations": [
      "Increase timing randomization",
      "Implement more aggressive dummy traffic",
      "Consider using traffic shaping"
    ]
  },
  "security_score": {
    "score": 60,
    "grade": "D",
    "factors": [
      "No padding detected (-10)",
      "High correlation risk (-30)"
    ]
  }
}